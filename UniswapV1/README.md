##Uniswap-v1的基本实现##
学习[教程](https://github.com/Dapp-Learning-DAO/Dapp-Learning/blob/main/basic/13-decentralized-exchange/uniswap-v1-like/README.md)的笔记

第一版本的uniswap，只支持eth和erc20合约之间的互相转换。

# 1、uniswap介绍

一个可以实现ETH和ERC20Token互换的去中心化交易所(Decentralize EXchange/DEX)。

说到交易所，第一时间想到的就是挂单和吃单，通过订单薄实现。

为了保证市场有足够的流动性，会有做市商。避免挂单价差太大无法撮合，或者交易价格剧烈波动。

但是在DEX上，兑换对创建的门槛低，不需要专门的做市商，每个人都是做市商AMM。

基本公式` x*y=k`

兑换对的两者数量之积固定为k。
当提供流动性时，也按照x、y相同的比例扣减代币和ETH。
兑换时，最后的兑换剩余`x'*y'=k` 即 `(x-a)(y+b)=x*y` 这里b是投入的token数量，a是兑换得到的token数量

实现上，分为两个部分。

Factory负责Pool合约的管理。
Pool负责实际的兑换和流动性管理。


# 2、Factory合约
负责合约的创建和管理。其中维护一个map，用户记录兑换的token对和Pool合约地址的映射关系。

# 3、Pool合约
无常损失：提供流动性的时候，总资产金额为X。有其他人交易后，该流动性的价值为y。小于x，这部分的差值就是无常损失。

**手续费**：为了激励流动性，需要对交易的部分扣除手续费，然后在退出流动性的时候，按比例分发。

举个例子：
A、B用户分别提供25、50的流动性，此时代币C有50，代币D有100个。A、B获得流动性标记各25个。
经过几轮交易后，C:60，D:120。
此时如果A退出流动性，则获得C30个，D60个。多出来的就是手续费收益。
此时如果E投入流动性，C:60，D:120个，同时获得流动性标记50个。


**流动性标记**：这里需要记录用户的流动性标记，实现上基于ERC20，记录流动性见证。
	



